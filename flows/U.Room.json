[
  {
    "id": "aab0c030de7df5cc",
    "type": "tab",
    "label": "U.Room",
    "disabled": false,
    "info": "",
    "env": []
  },
  {
    "id": "0aeb80f7dfc7025e",
    "type": "group",
    "z": "aab0c030de7df5cc",
    "name": "room - bucket",
    "style": {
      "fill": "#ffC000",
      "fill-opacity": "0.05",
      "label": true,
      "stroke": "#ffC000"
    },
    "nodes": [
      "606f3caa9058900f",
      "4e6003732b266fe2",
      "68c4344a4704c54f"
    ],
    "x": 94,
    "y": 19,
    "w": 342,
    "h": 82
  },
  {
    "id": "f6132c9f3c5a2911",
    "type": "group",
    "z": "aab0c030de7df5cc",
    "name": "room - metric",
    "style": {
      "fill": "#0070c0",
      "fill-opacity": "0.05",
      "label": true
    },
    "nodes": [
      "116de42631d4b17a",
      "f138e16b633d9429",
      "2690f4e06626ebda"
    ],
    "x": 1054,
    "y": 19,
    "w": 342,
    "h": 82
  },
  {
    "id": "8ebd43deda9d56d4",
    "type": "group",
    "z": "aab0c030de7df5cc",
    "name": "room - config",
    "style": {
      "fill": "#777777",
      "fill-opacity": "0.05",
      "label": true
    },
    "nodes": [
      "0bdefb56ee5ef918",
      "fedaeb34f9bc97e4"
    ],
    "x": 68,
    "y": 173,
    "w": 1454,
    "h": 194
  },
  {
    "id": "b64c96e257072f51",
    "type": "group",
    "z": "aab0c030de7df5cc",
    "name": "room - selection",
    "style": {
      "fill": "#ff0000",
      "fill-opacity": "0.05",
      "label": true
    },
    "nodes": [
      "66835e34ae95f3f0",
      "9ee5e12567650c9d",
      "3b74b2448cdb18a9",
      "b2e5e7af716d4ec6",
      "aa39991b7847c574",
      "1dd86a8b8b446749",
      "3ec4a86ec9ec37f6",
      "ef424db05e8a1103",
      "1c55a9cf641c38ba",
      "4ed33d50e1b4ebc9",
      "656d1866a8ae8cf8",
      "9e4bfee0db3051d4",
      "74172837e07ab80d",
      "1be6ca3c2b8615a2",
      "06976c9133796ab8",
      "3d2ea19ae9c4b9d2",
      "9043871af737eb1a",
      "b6323e1460f6f50c",
      "eed5df5df9eb8030",
      "b375ca01bb8f1e43",
      "dc4343f890e4a3e1",
      "57e1a96c1bf54302"
    ],
    "x": 94,
    "y": 439,
    "w": 1432,
    "h": 442
  },
  {
    "id": "094bebacb1145e5f",
    "type": "group",
    "z": "aab0c030de7df5cc",
    "name": "room - various",
    "style": {
      "label": true,
      "fill": "#777777",
      "fill-opacity": "0.05"
    },
    "nodes": [
      "4e8f7076589ea977",
      "42c0f1473438a281"
    ],
    "x": 68,
    "y": 1913,
    "w": 2344,
    "h": 1334
  },
  {
    "id": "f68e8c6415aca870",
    "type": "group",
    "z": "aab0c030de7df5cc",
    "name": "catch error",
    "style": {
      "fill": "#ff0000",
      "fill-opacity": "0.05",
      "label": true,
      "stroke": "#ff0000"
    },
    "nodes": [
      "a2a26d3c15589044",
      "fcaaaca3a27426b7",
      "69fc7c7c14fa81f3"
    ],
    "x": 534,
    "y": 19,
    "w": 422,
    "h": 82
  },
  {
    "id": "37f02e75f6e70daa",
    "type": "group",
    "z": "aab0c030de7df5cc",
    "name": "home - linky - ui",
    "style": {
      "fill": "#6f2fa0",
      "fill-opacity": "0.05",
      "label": true
    },
    "nodes": [
      "ff3ea6db082a3ede",
      "7a8446bfe5858de9",
      "7ca84197b56de1f6",
      "5f8cd6bd9f561403",
      "3c5b954c4db04bdb",
      "3a816c9d45c03626",
      "d387848d485bbad4",
      "88b4fa01095bf6be",
      "9afdec924f923d90",
      "6ef64156f6aee952",
      "ab09e46f4313cec3",
      "88a3ebf72baa83c9",
      "7bde9e5371850ec6",
      "94a9afc0489abcb3",
      "76f6a0873cbd318f",
      "a86d64f42452a3b7",
      "2c63dd2b7c70df86",
      "ce16a38c205cea88",
      "223c9437360c96cb",
      "8a1c1129f96fc4f7",
      "2da12c408933c87b",
      "bb91528b79a7fef4",
      "5ee9de3d5907e482",
      "f8bf0c474caebb26",
      "9725fd4ac3730948",
      "da46e6b6c18a5350",
      "53c25ef43112837d",
      "674e46c767bb1ff9",
      "636a8238144e0df5"
    ],
    "x": 94,
    "y": 3379,
    "w": 1612,
    "h": 502
  },
  {
    "id": "1d72cb06c368a2c9",
    "type": "group",
    "z": "aab0c030de7df5cc",
    "name": "room - chart",
    "style": {
      "label": true,
      "fill": "#777777",
      "fill-opacity": "0.05"
    },
    "nodes": [
      "a3df49e3ec177d8d",
      "80f986da1d02c67c",
      "0db8801c7e0e4401"
    ],
    "x": 68,
    "y": 953,
    "w": 2484,
    "h": 914
  },
  {
    "id": "a3df49e3ec177d8d",
    "type": "group",
    "z": "aab0c030de7df5cc",
    "g": "1d72cb06c368a2c9",
    "name": "room - ui - chart temperature",
    "style": {
      "fill": "#6f2fa0",
      "fill-opacity": "0.05",
      "label": true
    },
    "nodes": [
      "ec99f621f7253cd7",
      "023b97f731941ec8",
      "d83b592e2491dcb6",
      "e44987d599f2b366",
      "b6d352f0739c9c5d",
      "e01a8d98754f1f85",
      "c1d200de7bed7d83",
      "3918bb15caaf1ec5",
      "4a56f9148bd23d8e",
      "fc6afa9a094180d3",
      "44d4e7ddd6c2f416",
      "20c48f73de388537"
    ],
    "x": 94,
    "y": 979,
    "w": 1292,
    "h": 202
  },
  {
    "id": "80f986da1d02c67c",
    "type": "group",
    "z": "aab0c030de7df5cc",
    "g": "1d72cb06c368a2c9",
    "name": "room - ui - chart humidity",
    "style": {
      "fill": "#6f2fa0",
      "fill-opacity": "0.05",
      "label": true
    },
    "nodes": [
      "1f143110084f2d12",
      "c95545cb575e900a",
      "a521b0c77c8e1b96",
      "057bd2913e07a3dc",
      "588f7e8cf7861975",
      "feae7dc17ccbe84b",
      "40fb52f0b9b6d6f8",
      "5943f812794763bb",
      "280a3b24aff09fd6",
      "13bb4993d29c190f",
      "4fac1159c7fb1196",
      "238894bac5405d86"
    ],
    "x": 94,
    "y": 1219,
    "w": 1292,
    "h": 202
  },
  {
    "id": "0db8801c7e0e4401",
    "type": "group",
    "z": "aab0c030de7df5cc",
    "g": "1d72cb06c368a2c9",
    "name": "room - ui - chart power",
    "style": {
      "fill": "#6f2fa0",
      "fill-opacity": "0.05",
      "label": true
    },
    "nodes": [
      "44795f19725dfb16",
      "2b909499790cab01",
      "73cb2cee63b22726",
      "eeab0942d3417e79",
      "23dabc507247dfc0",
      "992ae204a4e2dac4",
      "32acac8443b52345",
      "b9f8b477c288e0f0",
      "ecd8bf936f027cdc",
      "c60c3603ff04bca1",
      "5cc27b9e016bbe1b",
      "fea7dd1138155750",
      "ce300a4fa3da028b",
      "5c3172390ae5eefb",
      "898d54359ae10f09",
      "4ca2710a68ee8cf7",
      "ea377511bda2edc5",
      "8bb2921d3035f78f",
      "d28afb23b014c0d3",
      "2b7c57be9b721cd6",
      "8baf81aaecbe3ab0",
      "f64316cbc425c3fb",
      "27ccfea85f2033da",
      "529b8f85ea492b9a",
      "154312b0a80ad157",
      "8bc96e353c45fe20",
      "a8c19f86a71e21fe"
    ],
    "x": 94,
    "y": 1459,
    "w": 2432,
    "h": 382
  },
  {
    "id": "0bdefb56ee5ef918",
    "type": "group",
    "z": "aab0c030de7df5cc",
    "g": "8ebd43deda9d56d4",
    "name": "room - config - device",
    "style": {
      "fill": "#ffC000",
      "fill-opacity": "0.05",
      "label": true
    },
    "nodes": [
      "177aee50c214945c",
      "ca620b08c9922bd0",
      "8d6827df412a4059"
    ],
    "x": 94,
    "y": 199,
    "w": 502,
    "h": 82
  },
  {
    "id": "fedaeb34f9bc97e4",
    "type": "group",
    "z": "aab0c030de7df5cc",
    "g": "8ebd43deda9d56d4",
    "name": "room - config - ui",
    "style": {
      "fill": "#6f2fa0",
      "fill-opacity": "0.05",
      "label": true
    },
    "nodes": [
      "b6c03b0d5a9952c9",
      "9a20f95447f8ddfd",
      "d4f555ae99a41fee",
      "cd4ebdd2c6d86368",
      "48ee82efe7b41570",
      "290e5853a51cb170",
      "e15462f85288d3c0"
    ],
    "x": 694,
    "y": 199,
    "w": 802,
    "h": 142
  },
  {
    "id": "4e8f7076589ea977",
    "type": "group",
    "z": "aab0c030de7df5cc",
    "g": "094bebacb1145e5f",
    "name": "room - ui - sensor",
    "style": {
      "fill": "#6f2fa0",
      "fill-opacity": "0.05",
      "label": true
    },
    "nodes": [
      "dfb1c71d12e96d7e",
      "01e05de4b3ca9c5f",
      "f4795bfce2a04229",
      "1e12a54af3ef13b7",
      "88b32f9b417c1d89",
      "fd4ef897d9752a3c",
      "24e20be30ebc92aa",
      "8a52378a44bf7f3b",
      "9615af109f15be41",
      "59c93aa71ad35d29",
      "6c94f5bf30aea70d",
      "8fb6a9d9412b2bec",
      "88b22e34de3b524d",
      "d05c1a4eee3f01e4",
      "e46801b96418c26a",
      "d7aff9d041ae7444",
      "a81fa955d6562f5f",
      "5cc6b20c6df480dd",
      "689bb472e2d91059",
      "20c75ef7e51d5b8e",
      "e0045ca80f8e03c1",
      "0a90a652239db393",
      "3fddcb78e40b1d2b",
      "778d16bd84481a10",
      "93a7acc4ebb52d85",
      "c0b755705bfe5f7c",
      "68ac80a46640bc8a",
      "4f1473471bbae45e",
      "8585e6f3431e8d42",
      "83438124d9dced41",
      "035559e237d36f74",
      "b0e2b38384530493",
      "adf79dcb4ba8b960",
      "25fcf6d56ac6dc3a",
      "18e8c1312e9832c1",
      "2109f9c2efef71b7",
      "d37f5597502da265",
      "c22c3490c00ce12b",
      "3cb202072fae30ca",
      "cecdc0524ebf11ca"
    ],
    "x": 94,
    "y": 1939,
    "w": 2292,
    "h": 802
  },
  {
    "id": "42c0f1473438a281",
    "type": "group",
    "z": "aab0c030de7df5cc",
    "g": "094bebacb1145e5f",
    "name": "room - ui - camera",
    "style": {
      "fill": "#6f2fa0",
      "fill-opacity": "0.05",
      "label": true
    },
    "nodes": [
      "24f76309a6dfe14a",
      "6bd965a44bd48431",
      "4adc84859872765c",
      "78f2cb047057edc0",
      "ef4532a3ebf0b36e",
      "967fea7a3b32f198",
      "16094297767ce839",
      "50c35b8d464c83cd",
      "d1904515488ddaf4",
      "725065af055abe45",
      "fb170cb858137be7",
      "b74b0ea99d56eb7e",
      "ea0406109e5de115",
      "03b02d165b1d7e28",
      "153555b528c18e18",
      "263b6e6e05263288",
      "b60115a1fd023b76",
      "c2aa1840a5deddbf",
      "62c1bb0cb832960f",
      "8aa78c963092f63a",
      "9775046f290c1bf5",
      "c32cc33c321acd07",
      "8c7c93ce9d3d346c",
      "b7732e5da33d4247",
      "ae7ba0058dad62d1",
      "0ff03eeb1954d8f2",
      "8dfe90979253107e"
    ],
    "x": 94,
    "y": 2779,
    "w": 2292,
    "h": 442
  },
  {
    "id": "606f3caa9058900f",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "0aeb80f7dfc7025e",
    "name": "bucket",
    "rules": [
      {
        "t": "set",
        "p": "bucket",
        "pt": "msg",
        "to": "room",
        "tot": "str"
      },
      {
        "t": "set",
        "p": "bucket",
        "pt": "flow",
        "to": "bucket",
        "tot": "msg"
      },
      {
        "t": "set",
        "p": "room",
        "pt": "flow",
        "to": "",
        "tot": "str"
      },
      {
        "t": "set",
        "p": "index",
        "pt": "flow",
        "to": "{}",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 270,
    "y": 60,
    "wires": [
      [
        "68c4344a4704c54f"
      ]
    ]
  },
  {
    "id": "4e6003732b266fe2",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "0aeb80f7dfc7025e",
    "name": "room - bucket",
    "links": [
      "25445f5a9b787a0a"
    ],
    "x": 135,
    "y": 60,
    "wires": [
      [
        "606f3caa9058900f"
      ]
    ]
  },
  {
    "id": "68c4344a4704c54f",
    "type": "link out",
    "z": "aab0c030de7df5cc",
    "g": "0aeb80f7dfc7025e",
    "name": "room - bucket",
    "mode": "link",
    "links": [
      "177aee50c214945c"
    ],
    "x": 395,
    "y": 60,
    "wires": []
  },
  {
    "id": "116de42631d4b17a",
    "type": "link out",
    "z": "aab0c030de7df5cc",
    "g": "f6132c9f3c5a2911",
    "name": "room - metric",
    "mode": "link",
    "links": [
      "206c1fb4a48067df"
    ],
    "x": 1355,
    "y": 60,
    "wires": []
  },
  {
    "id": "f138e16b633d9429",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "f6132c9f3c5a2911",
    "name": "set metric",
    "rules": [
      {
        "t": "set",
        "p": "bucket",
        "pt": "msg",
        "to": "room",
        "tot": "flow"
      },
      {
        "t": "set",
        "p": "field",
        "pt": "msg",
        "to": "topic",
        "tot": "msg"
      },
      {
        "t": "set",
        "p": "repeat",
        "pt": "msg",
        "to": "true",
        "tot": "bool"
      },
      {
        "t": "delete",
        "p": "path",
        "pt": "msg"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1220,
    "y": 60,
    "wires": [
      [
        "116de42631d4b17a"
      ]
    ]
  },
  {
    "id": "2690f4e06626ebda",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "f6132c9f3c5a2911",
    "name": "room - metric",
    "links": [
      "1c698f378d20c0c8",
      "60368ba60dfa48a3",
      "89d8b374ec0c8d64",
      "f1cc0ee7d294d743",
      "ef9a2b91b42284b7",
      "79e409df0c12d8bb",
      "1ef76a4c1fab9b78",
      "8ee8772fa3a4c742",
      "8beb2a2f4c26c437",
      "9d8b8d237e2704ea",
      "8a6f97848d7b1a2c",
      "5024c05850b207a9",
      "1d6b2ca73ae11560",
      "8c7c93ce9d3d346c",
      "165086f5eeb45889",
      "c17daf8aa7e26a0c"
    ],
    "x": 1095,
    "y": 60,
    "wires": [
      [
        "f138e16b633d9429"
      ]
    ]
  },
  {
    "id": "177aee50c214945c",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "0bdefb56ee5ef918",
    "name": "room - config - device",
    "links": [
      "68c4344a4704c54f"
    ],
    "x": 135,
    "y": 240,
    "wires": [
      [
        "ca620b08c9922bd0"
      ]
    ]
  },
  {
    "id": "ca620b08c9922bd0",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "0bdefb56ee5ef918",
    "name": "config / reset timer / number / 5",
    "rules": [
      {
        "t": "set",
        "p": "measurement",
        "pt": "msg",
        "to": "config",
        "tot": "str"
      },
      {
        "t": "set",
        "p": "field",
        "pt": "msg",
        "to": "reset timer",
        "tot": "str"
      },
      {
        "t": "set",
        "p": "format",
        "pt": "msg",
        "to": "number",
        "tot": "str"
      },
      {
        "t": "set",
        "p": "default",
        "pt": "msg",
        "to": "5",
        "tot": "num"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 350,
    "y": 240,
    "wires": [
      [
        "8d6827df412a4059"
      ]
    ]
  },
  {
    "id": "8d6827df412a4059",
    "type": "link out",
    "z": "aab0c030de7df5cc",
    "g": "0bdefb56ee5ef918",
    "name": "room - config - device",
    "mode": "link",
    "links": [
      "bfa594bf1f876c92"
    ],
    "x": 555,
    "y": 240,
    "wires": []
  },
  {
    "id": "b6c03b0d5a9952c9",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "fedaeb34f9bc97e4",
    "name": "room - config - ui - metric",
    "links": [
      "031a6afd8300356a"
    ],
    "x": 735,
    "y": 240,
    "wires": [
      [
        "d4f555ae99a41fee"
      ]
    ]
  },
  {
    "id": "9a20f95447f8ddfd",
    "type": "link out",
    "z": "aab0c030de7df5cc",
    "g": "fedaeb34f9bc97e4",
    "name": "room - config - ui - metric",
    "mode": "link",
    "links": [
      "206c1fb4a48067df"
    ],
    "x": 1455,
    "y": 300,
    "wires": []
  },
  {
    "id": "d4f555ae99a41fee",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "fedaeb34f9bc97e4",
    "name": "check path",
    "property": "path",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "room/config/reset timer",
        "vt": "str"
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 890,
    "y": 240,
    "wires": [
      [
        "cd4ebdd2c6d86368"
      ]
    ]
  },
  {
    "id": "48ee82efe7b41570",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "fedaeb34f9bc97e4",
    "name": "set metric",
    "rules": [
      {
        "t": "set",
        "p": "bucket",
        "pt": "msg",
        "to": "bucket",
        "tot": "flow"
      },
      {
        "t": "set",
        "p": "measurement",
        "pt": "msg",
        "to": "config",
        "tot": "str"
      },
      {
        "t": "set",
        "p": "field",
        "pt": "msg",
        "to": "topic",
        "tot": "msg"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1320,
    "y": 300,
    "wires": [
      [
        "9a20f95447f8ddfd"
      ]
    ]
  },
  {
    "id": "290e5853a51cb170",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "fedaeb34f9bc97e4",
    "name": "room - config - ui - load",
    "links": [
      "94c79b8f52f0b6ba"
    ],
    "x": 735,
    "y": 300,
    "wires": [
      [
        "e15462f85288d3c0"
      ]
    ]
  },
  {
    "id": "e15462f85288d3c0",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "fedaeb34f9bc97e4",
    "name": "from global metrics",
    "rules": [
      {
        "t": "set",
        "p": "bucket",
        "pt": "msg",
        "to": "bucket",
        "tot": "flow"
      },
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "metrics[msg.bucket]config['reset timer']",
        "tot": "global"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 910,
    "y": 300,
    "wires": [
      [
        "cd4ebdd2c6d86368"
      ]
    ]
  },
  {
    "id": "66835e34ae95f3f0",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "set room",
    "rules": [
      {
        "t": "set",
        "p": "room",
        "pt": "msg",
        "to": "payload",
        "tot": "msg"
      },
      {
        "t": "set",
        "p": "room",
        "pt": "flow",
        "to": "payload",
        "tot": "msg"
      },
      {
        "t": "set",
        "p": "page_title",
        "pt": "msg",
        "to": "payload",
        "tot": "msg"
      },
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "metrics[msg.payload]",
        "tot": "global"
      },
      {
        "t": "set",
        "p": "index",
        "pt": "flow",
        "to": "{}",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 280,
    "y": 720,
    "wires": [
      [
        "b375ca01bb8f1e43",
        "3b74b2448cdb18a9"
      ]
    ]
  },
  {
    "id": "9ee5e12567650c9d",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "enabled metric",
    "rules": [
      {
        "t": "set",
        "p": "enabled",
        "pt": "msg",
        "to": "true",
        "tot": "bool"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1100,
    "y": 840,
    "wires": [
      [
        "dc4343f890e4a3e1"
      ]
    ]
  },
  {
    "id": "3b74b2448cdb18a9",
    "type": "split",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "split bucket",
    "splt": "\\n",
    "spltType": "str",
    "arraySplt": 1,
    "arraySpltType": "len",
    "stream": false,
    "addname": "measurement",
    "x": 470,
    "y": 780,
    "wires": [
      [
        "b2e5e7af716d4ec6"
      ]
    ]
  },
  {
    "id": "b2e5e7af716d4ec6",
    "type": "split",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "split measurement",
    "splt": "\\n",
    "spltType": "str",
    "arraySplt": 1,
    "arraySpltType": "len",
    "stream": false,
    "addname": "field",
    "x": 690,
    "y": 780,
    "wires": [
      [
        "aa39991b7847c574"
      ]
    ]
  },
  {
    "id": "aa39991b7847c574",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "cleanup",
    "rules": [
      {
        "t": "set",
        "p": "bucket",
        "pt": "msg",
        "to": "room",
        "tot": "flow"
      },
      {
        "t": "delete",
        "p": "parts",
        "pt": "msg"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 900,
    "y": 780,
    "wires": [
      [
        "9ee5e12567650c9d"
      ]
    ]
  },
  {
    "id": "1dd86a8b8b446749",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "disabled elements",
    "rules": [
      {
        "t": "set",
        "p": "enabled",
        "pt": "msg",
        "to": "false",
        "tot": "bool"
      },
      {
        "t": "set",
        "p": "room",
        "pt": "msg",
        "to": "",
        "tot": "str"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "remove",
        "tot": "str"
      },
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "false",
        "tot": "bool"
      },
      {
        "t": "set",
        "p": "options",
        "pt": "msg",
        "to": "[{'label':'N/A','value':''}]",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1270,
    "y": 660,
    "wires": [
      [
        "9e4bfee0db3051d4"
      ]
    ]
  },
  {
    "id": "3ec4a86ec9ec37f6",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "room - selection - metric",
    "links": [
      "031a6afd8300356a"
    ],
    "x": 135,
    "y": 840,
    "wires": [
      [
        "ef424db05e8a1103"
      ]
    ]
  },
  {
    "id": "ef424db05e8a1103",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "check bucket",
    "property": "bucket",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "room",
        "vt": "flow"
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 290,
    "y": 840,
    "wires": [
      [
        "9ee5e12567650c9d"
      ]
    ]
  },
  {
    "id": "1c55a9cf641c38ba",
    "type": "trigger",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "wait delay then reset visibility",
    "op1": "",
    "op2": "",
    "op1type": "nul",
    "op2type": "str",
    "duration": "30",
    "extend": true,
    "overrideDelay": true,
    "units": "s",
    "reset": "",
    "bytopic": "all",
    "topic": "topic",
    "outputs": 1,
    "x": 580,
    "y": 540,
    "wires": [
      [
        "4ed33d50e1b4ebc9"
      ]
    ]
  },
  {
    "id": "4ed33d50e1b4ebc9",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "unset room",
    "rules": [
      {
        "t": "set",
        "p": "room",
        "pt": "flow",
        "to": "",
        "tot": "str"
      },
      {
        "t": "set",
        "p": "room",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 830,
    "y": 480,
    "wires": [
      [
        "9043871af737eb1a"
      ]
    ]
  },
  {
    "id": "656d1866a8ae8cf8",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "set visibility delay",
    "rules": [
      {
        "t": "set",
        "p": "delay",
        "pt": "msg",
        "to": "metrics.room.config['reset timer']",
        "tot": "global"
      },
      {
        "t": "set",
        "p": "delay",
        "pt": "msg",
        "to": "msg.delay*60000",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 310,
    "y": 540,
    "wires": [
      [
        "1c55a9cf641c38ba"
      ]
    ]
  },
  {
    "id": "9e4bfee0db3051d4",
    "type": "link out",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "room - selection - reset",
    "mode": "link",
    "links": [
      "dfb1c71d12e96d7e",
      "d1904515488ddaf4",
      "c6f86ceb44d413ed",
      "80c3ce3d49bd331a",
      "fa99b8b44e92f9be",
      "5f3f7c722ac856e1",
      "e804fb2bad48ce0d",
      "9eec2a58eea2f794",
      "b8ed61d35607d163",
      "ef2769915480b0f6",
      "d58e31cbba7fe1fb",
      "9737afb19d9c9fbb",
      "3bd921f16659d915",
      "511350d9f34ce767",
      "a06fcd9bc49dd111",
      "97aa2e016643bfbd",
      "5f5234be5bf42b3a",
      "e01a8d98754f1f85",
      "feae7dc17ccbe84b",
      "88a3ebf72baa83c9",
      "23dabc507247dfc0",
      "71d0e8896af92442",
      "a033c6dbdefb80f9",
      "3f26e65e9e14b140",
      "6ab8f6f585ebee36"
    ],
    "x": 1435,
    "y": 660,
    "wires": []
  },
  {
    "id": "74172837e07ab80d",
    "type": "link out",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "room - seletion - select",
    "mode": "link",
    "links": [
      "0588224c71e286ea",
      "2c612fdffe67f6a1",
      "05413d613ec94002",
      "d6202f83353ef991",
      "dcf6e22992b1a266",
      "9e08854ef865d0d7",
      "6b83b5c2984312c4",
      "dc88725defb60f1a",
      "06a05a3b06eca91f",
      "1ce42313fa49e65c",
      "337f1fd20587c947",
      "835ca54b2c05e702",
      "96adf7bcdf4b3817",
      "da3a569002e98615",
      "2d281d07956505d2",
      "768aebc01cc24cfa",
      "49f81da257fd1bd5",
      "b5fb778a5f959426",
      "7bfbfd723b885933",
      "29f190c009d9bd2b"
    ],
    "x": 1395,
    "y": 600,
    "wires": []
  },
  {
    "id": "1be6ca3c2b8615a2",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "room - selection - select",
    "links": [
      "019a3a8edd5faf37",
      "2a9d3ecd8577a6f1",
      "5f57bad104da1bb5",
      "bbf50f3943683db6",
      "57edb1e8b87cefb2",
      "d9435658511d2531",
      "c11914e72f89fb79",
      "44bf80d373658b2d",
      "92e5847f6900c415",
      "ddd7a64191f066e2",
      "4526a823900a3869",
      "72159ff35b8394bc",
      "f62a05821139fc1e",
      "c5652bf083077eba",
      "3e0916086ca22bc8",
      "d1fa2ec297591574",
      "d6a7e2cef723dc90",
      "0ffed8fdad553396",
      "167294a666df090a",
      "601b5a75c014b306"
    ],
    "x": 135,
    "y": 660,
    "wires": [
      [
        "1dd86a8b8b446749",
        "656d1866a8ae8cf8",
        "66835e34ae95f3f0",
        "3d2ea19ae9c4b9d2"
      ]
    ]
  },
  {
    "id": "06976c9133796ab8",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "room - selection - reset",
    "links": [
      "94c79b8f52f0b6ba"
    ],
    "x": 135,
    "y": 480,
    "wires": [
      [
        "4ed33d50e1b4ebc9"
      ]
    ]
  },
  {
    "id": "3d2ea19ae9c4b9d2",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "payload to room",
    "rules": [
      {
        "t": "set",
        "p": "room",
        "pt": "msg",
        "to": "payload",
        "tot": "msg"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 300,
    "y": 600,
    "wires": [
      [
        "74172837e07ab80d"
      ]
    ]
  },
  {
    "id": "9043871af737eb1a",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "reset menu title",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "",
        "tot": "str"
      },
      {
        "t": "set",
        "p": "page_title",
        "pt": "msg",
        "to": "Selectionner une pièce",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1040,
    "y": 480,
    "wires": [
      [
        "b375ca01bb8f1e43",
        "57e1a96c1bf54302",
        "1dd86a8b8b446749"
      ]
    ]
  },
  {
    "id": "b6323e1460f6f50c",
    "type": "link out",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "room - selection - metric",
    "mode": "link",
    "links": [
      "8a52378a44bf7f3b",
      "725065af055abe45",
      "6d6224968ba7c5d9",
      "3bc4111acd19c69a",
      "8b94e3c61d1c7e5d",
      "6d778528ac85f061",
      "cdf2ad725fe8ba54",
      "f7f44b26d3494661",
      "4c93ed77e680ad7a",
      "4bea82d34bf79d91",
      "6ebcb13cc88ec167",
      "dd49b4996fb683ff",
      "c97e08992c83f769",
      "7aaae6f81accc54b",
      "b1825677cbba4273",
      "383c38e98cd05755",
      "c72c85a05c057eb6",
      "e44987d599f2b366",
      "057bd2913e07a3dc",
      "223c9437360c96cb",
      "eeab0942d3417e79",
      "157c2c86081bbfab",
      "761cb37547fe4dc2",
      "26655f3b52fd390b",
      "7379c487515b9889"
    ],
    "x": 1415,
    "y": 840,
    "wires": []
  },
  {
    "id": "b375ca01bb8f1e43",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "format payload",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "$uppercase(msg.page_title)",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1260,
    "y": 720,
    "wires": [
      [
        "eed5df5df9eb8030"
      ]
    ]
  },
  {
    "id": "dc4343f890e4a3e1",
    "type": "delay",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "50 ms",
    "pauseType": "delay",
    "timeout": "50",
    "timeoutUnits": "milliseconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "second",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": false,
    "allowrate": false,
    "outputs": 1,
    "x": 1290,
    "y": 840,
    "wires": [
      [
        "b6323e1460f6f50c"
      ]
    ]
  },
  {
    "id": "57e1a96c1bf54302",
    "type": "delay",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "name": "wait 100 ms",
    "pauseType": "delay",
    "timeout": "100",
    "timeoutUnits": "milliseconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "second",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": false,
    "allowrate": false,
    "outputs": 1,
    "x": 1250,
    "y": 540,
    "wires": [
      [
        "74172837e07ab80d"
      ]
    ]
  },
  {
    "id": "cd4ebdd2c6d86368",
    "type": "ui-slider",
    "z": "aab0c030de7df5cc",
    "g": "fedaeb34f9bc97e4",
    "group": "d464a60fe4e4c421",
    "name": "reset delay",
    "label": "Délai de remise à zéro",
    "tooltip": "",
    "order": 0,
    "width": "6",
    "height": "1",
    "passthru": false,
    "outs": "end",
    "topic": "reset timer",
    "topicType": "str",
    "thumbLabel": true,
    "min": "1",
    "max": "30",
    "step": "0.5",
    "className": "",
    "x": 1130,
    "y": 300,
    "wires": [
      [
        "48ee82efe7b41570"
      ]
    ]
  },
  {
    "id": "eed5df5df9eb8030",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "g": "b64c96e257072f51",
    "group": "36396f5285df476c",
    "order": 1,
    "width": "6",
    "height": "1",
    "name": "Pièce",
    "label": "",
    "format": "{{msg.payload}}",
    "layout": "row-center",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 1450,
    "y": 720,
    "wires": []
  },
  {
    "id": "dfb1c71d12e96d7e",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "room - ui - sensor - load",
    "links": [
      "9e4bfee0db3051d4"
    ],
    "x": 135,
    "y": 1980,
    "wires": [
      [
        "01e05de4b3ca9c5f",
        "3cb202072fae30ca"
      ]
    ]
  },
  {
    "id": "01e05de4b3ca9c5f",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "reset",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "{\t   \"groups\":{\t       \"hide\":[\"Pièces:Capteurs\"]\t   }\t}",
        "tot": "jsonata"
      },
      {
        "t": "set",
        "p": "reset",
        "pt": "msg",
        "to": "true",
        "tot": "bool"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1970,
    "y": 1980,
    "wires": [
      [
        "20c75ef7e51d5b8e",
        "0a90a652239db393"
      ]
    ]
  },
  {
    "id": "f4795bfce2a04229",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "set",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "{\t   \"groups\":{\t       \"show\":[\"Pièces:Capteurs\"]\t   }\t}",
        "tot": "jsonata"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "remove",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1970,
    "y": 2040,
    "wires": [
      [
        "0a90a652239db393",
        "20c75ef7e51d5b8e"
      ]
    ]
  },
  {
    "id": "1e12a54af3ef13b7",
    "type": "link call",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "",
    "links": [
      "ddd39f991efd9d31"
    ],
    "linkType": "static",
    "timeout": "0.5",
    "x": 1610,
    "y": 2160,
    "wires": [
      [
        "3fddcb78e40b1d2b"
      ]
    ]
  },
  {
    "id": "88b32f9b417c1d89",
    "type": "link call",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "",
    "links": [
      "49927aaaafcc60ec"
    ],
    "linkType": "static",
    "timeout": "0.5",
    "x": 1600,
    "y": 2280,
    "wires": [
      [
        "778d16bd84481a10"
      ]
    ]
  },
  {
    "id": "fd4ef897d9752a3c",
    "type": "link call",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "",
    "links": [
      "aa96d5f77fcf68e5"
    ],
    "linkType": "static",
    "timeout": "0.5",
    "x": 1610,
    "y": 2400,
    "wires": [
      [
        "93a7acc4ebb52d85"
      ]
    ]
  },
  {
    "id": "24e20be30ebc92aa",
    "type": "link call",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "",
    "links": [
      "12b1109de2f09cfc"
    ],
    "linkType": "static",
    "timeout": "0.5",
    "x": 1600,
    "y": 2520,
    "wires": [
      [
        "c0b755705bfe5f7c"
      ]
    ]
  },
  {
    "id": "8a52378a44bf7f3b",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "room - ui - sensor - metric",
    "links": [
      "b6323e1460f6f50c"
    ],
    "x": 135,
    "y": 2040,
    "wires": [
      [
        "035559e237d36f74"
      ]
    ]
  },
  {
    "id": "9615af109f15be41",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "select measurement",
    "property": "measurement",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "fire",
        "vt": "str"
      },
      {
        "t": "eq",
        "v": "temperature",
        "vt": "str"
      },
      {
        "t": "eq",
        "v": "humidity",
        "vt": "str"
      },
      {
        "t": "eq",
        "v": "luminosity",
        "vt": "str"
      },
      {
        "t": "eq",
        "v": "motion",
        "vt": "str"
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 5,
    "x": 1360,
    "y": 2160,
    "wires": [
      [],
      [
        "1e12a54af3ef13b7"
      ],
      [
        "88b32f9b417c1d89"
      ],
      [
        "fd4ef897d9752a3c"
      ],
      [
        "24e20be30ebc92aa"
      ]
    ]
  },
  {
    "id": "59c93aa71ad35d29",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "payload",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "msg.payload=true?'Mouvement détecté':'Aucun mouvement'",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1980,
    "y": 2520,
    "wires": [
      [
        "6c94f5bf30aea70d"
      ]
    ]
  },
  {
    "id": "6c94f5bf30aea70d",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "group": "82b3ef69e7817bbb",
    "order": 2,
    "width": "5",
    "height": "1",
    "name": "motion (txt)",
    "label": "",
    "format": "{{msg.payload}}",
    "layout": "row-right",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 2170,
    "y": 2520,
    "wires": []
  },
  {
    "id": "8fb6a9d9412b2bec",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "group": "82b3ef69e7817bbb",
    "order": 8,
    "width": "5",
    "height": "1",
    "name": "luminosity (txt)",
    "label": "",
    "format": "{{msg.payload}}",
    "layout": "row-right",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 2180,
    "y": 2400,
    "wires": []
  },
  {
    "id": "88b22e34de3b524d",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "payload",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "'Luminosité de '&msg.payload&'Lx'",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1980,
    "y": 2400,
    "wires": [
      [
        "8fb6a9d9412b2bec"
      ]
    ]
  },
  {
    "id": "d05c1a4eee3f01e4",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "payload",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "'Humidité à '&msg.payload&'%'",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1980,
    "y": 2280,
    "wires": [
      [
        "e46801b96418c26a"
      ]
    ]
  },
  {
    "id": "e46801b96418c26a",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "group": "82b3ef69e7817bbb",
    "order": 6,
    "width": "5",
    "height": "1",
    "name": "humidity (txt)",
    "label": "",
    "format": "{{msg.payload}}",
    "layout": "row-right",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 2170,
    "y": 2280,
    "wires": []
  },
  {
    "id": "d7aff9d041ae7444",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "payload",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "'Température de '&msg.payload&'°C'",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1980,
    "y": 2160,
    "wires": [
      [
        "a81fa955d6562f5f"
      ]
    ]
  },
  {
    "id": "a81fa955d6562f5f",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "group": "82b3ef69e7817bbb",
    "order": 4,
    "width": "5",
    "height": "1",
    "name": "temperature (txt)",
    "label": "",
    "format": "{{msg.payload}}",
    "layout": "row-right",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 2180,
    "y": 2160,
    "wires": []
  },
  {
    "id": "5cc6b20c6df480dd",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "group": "82b3ef69e7817bbb",
    "order": 10,
    "width": "5",
    "height": "1",
    "name": "fire (txt)",
    "label": "",
    "format": "{{msg.payload}}",
    "layout": "row-right",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 2160,
    "y": 2640,
    "wires": []
  },
  {
    "id": "689bb472e2d91059",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "payload",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "msg.payload=true?'Alarme incendie déclenchée':\"Aucun défaut d'incendie\"",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1980,
    "y": 2640,
    "wires": [
      [
        "5cc6b20c6df480dd"
      ]
    ]
  },
  {
    "id": "20c75ef7e51d5b8e",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "payload",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "Aucun capteur",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 2140,
    "y": 1980,
    "wires": [
      [
        "e0045ca80f8e03c1"
      ]
    ]
  },
  {
    "id": "e0045ca80f8e03c1",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "group": "82b3ef69e7817bbb",
    "order": 1,
    "width": "6",
    "height": "1",
    "name": "none",
    "label": "",
    "format": "{{msg.payload}}",
    "layout": "row-center",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 2310,
    "y": 1980,
    "wires": []
  },
  {
    "id": "0a90a652239db393",
    "type": "ui-control",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "",
    "ui": "2d75e4809d2a6fbf",
    "events": "all",
    "x": 2140,
    "y": 2040,
    "wires": [
      []
    ]
  },
  {
    "id": "3fddcb78e40b1d2b",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "rsp",
    "property": "search.response",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "1",
        "vt": "num"
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 1810,
    "y": 2160,
    "wires": [
      [
        "d7aff9d041ae7444",
        "d37f5597502da265"
      ]
    ]
  },
  {
    "id": "778d16bd84481a10",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "rsp",
    "property": "search.response",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "1",
        "vt": "num"
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 1810,
    "y": 2280,
    "wires": [
      [
        "d05c1a4eee3f01e4",
        "18e8c1312e9832c1"
      ]
    ]
  },
  {
    "id": "93a7acc4ebb52d85",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "rsp",
    "property": "search.response",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "1",
        "vt": "num"
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 1810,
    "y": 2400,
    "wires": [
      [
        "88b22e34de3b524d",
        "25fcf6d56ac6dc3a"
      ]
    ]
  },
  {
    "id": "c0b755705bfe5f7c",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "rsp",
    "property": "search.response",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "1",
        "vt": "num"
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 1810,
    "y": 2520,
    "wires": [
      [
        "59c93aa71ad35d29",
        "b0e2b38384530493"
      ]
    ]
  },
  {
    "id": "68ac80a46640bc8a",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "reset",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "true",
        "tot": "bool"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "remove",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1970,
    "y": 2100,
    "wires": [
      [
        "a81fa955d6562f5f",
        "e46801b96418c26a",
        "8fb6a9d9412b2bec",
        "6c94f5bf30aea70d",
        "5cc6b20c6df480dd",
        "b0e2b38384530493",
        "308199e1755f6e79",
        "adf79dcb4ba8b960",
        "cecdc0524ebf11ca",
        "2109f9c2efef71b7"
      ]
    ]
  },
  {
    "id": "4f1473471bbae45e",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "from global",
    "rules": [
      {
        "t": "set",
        "p": "scene.bucket",
        "pt": "msg",
        "to": "room",
        "tot": "flow"
      },
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "metrics[msg.scene.bucket]",
        "tot": "global"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 970,
    "y": 2160,
    "wires": [
      [
        "83438124d9dced41"
      ]
    ]
  },
  {
    "id": "8585e6f3431e8d42",
    "type": "trigger",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "wait 20ms then send 1",
    "op1": "",
    "op2": "1",
    "op1type": "nul",
    "op2type": "str",
    "duration": "20",
    "extend": false,
    "overrideDelay": false,
    "units": "ms",
    "reset": "",
    "bytopic": "all",
    "topic": "topic",
    "outputs": 1,
    "x": 560,
    "y": 2040,
    "wires": [
      [
        "f4795bfce2a04229",
        "c22c3490c00ce12b",
        "3cb202072fae30ca"
      ]
    ]
  },
  {
    "id": "83438124d9dced41",
    "type": "split",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "",
    "splt": "\\n",
    "spltType": "str",
    "arraySplt": 1,
    "arraySpltType": "len",
    "stream": false,
    "addname": "measurement",
    "x": 1150,
    "y": 2160,
    "wires": [
      [
        "9615af109f15be41"
      ]
    ]
  },
  {
    "id": "035559e237d36f74",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "limit measurement",
    "property": "measurement",
    "propertyType": "msg",
    "rules": [
      {
        "t": "regex",
        "v": "fire|temperature|humidity|luminosity|motion",
        "vt": "str",
        "case": false
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 310,
    "y": 2040,
    "wires": [
      [
        "8585e6f3431e8d42"
      ]
    ]
  },
  {
    "id": "24f76309a6dfe14a",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "select field",
    "property": "field",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "url",
        "vt": "str"
      },
      {
        "t": "eq",
        "v": "rstp",
        "vt": "str"
      },
      {
        "t": "eq",
        "v": "snapshot",
        "vt": "str"
      }
    ],
    "checkall": "true",
    "repair": false,
    "outputs": 3,
    "x": 550,
    "y": 3120,
    "wires": [
      [
        "50c35b8d464c83cd",
        "78f2cb047057edc0"
      ],
      [
        "50c35b8d464c83cd",
        "b74b0ea99d56eb7e"
      ],
      [
        "ae7ba0058dad62d1"
      ]
    ]
  },
  {
    "id": "6bd965a44bd48431",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "reset",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "{\t   \"groups\":{\t       \"hide\":[\"Pièces:Camera\"]\t   }\t}",
        "tot": "jsonata"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 730,
    "y": 2880,
    "wires": [
      [
        "ea0406109e5de115",
        "153555b528c18e18",
        "c2aa1840a5deddbf"
      ]
    ]
  },
  {
    "id": "4adc84859872765c",
    "type": "trigger",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "every second",
    "op1": "",
    "op2": "0",
    "op1type": "pay",
    "op2type": "str",
    "duration": "-1",
    "extend": false,
    "overrideDelay": false,
    "units": "s",
    "reset": "",
    "bytopic": "all",
    "topic": "topic",
    "outputs": 1,
    "x": 1290,
    "y": 3060,
    "wires": [
      [
        "ef4532a3ebf0b36e"
      ]
    ]
  },
  {
    "id": "78f2cb047057edc0",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "url",
    "rules": [
      {
        "t": "set",
        "p": "url",
        "pt": "msg",
        "to": "payload",
        "tot": "msg"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 730,
    "y": 3060,
    "wires": [
      [
        "8aa78c963092f63a"
      ]
    ]
  },
  {
    "id": "ef4532a3ebf0b36e",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "check url",
    "property": "url",
    "propertyType": "msg",
    "rules": [
      {
        "t": "nempty"
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 1480,
    "y": 3060,
    "wires": [
      [
        "967fea7a3b32f198"
      ]
    ]
  },
  {
    "id": "967fea7a3b32f198",
    "type": "http request",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "query camera url",
    "method": "GET",
    "ret": "bin",
    "paytoqs": "ignore",
    "url": "",
    "tls": "",
    "persist": false,
    "proxy": "",
    "insecureHTTPParser": false,
    "authType": "",
    "senderr": false,
    "headers": [],
    "x": 1690,
    "y": 3060,
    "wires": [
      [
        "16094297767ce839"
      ]
    ]
  },
  {
    "id": "50c35b8d464c83cd",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "set",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "{\t   \"groups\":{\t       \"show\":[\"Pièces:Camera\"]\t   }\t}",
        "tot": "jsonata"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "remove",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 730,
    "y": 2940,
    "wires": [
      [
        "ea0406109e5de115",
        "153555b528c18e18"
      ]
    ]
  },
  {
    "id": "d1904515488ddaf4",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "room - ui - camera - load",
    "links": [
      "9e4bfee0db3051d4"
    ],
    "x": 135,
    "y": 2880,
    "wires": [
      [
        "6bd965a44bd48431",
        "9775046f290c1bf5"
      ]
    ]
  },
  {
    "id": "725065af055abe45",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "room - ui - camera - metric",
    "links": [
      "b6323e1460f6f50c"
    ],
    "x": 135,
    "y": 3120,
    "wires": [
      [
        "fb170cb858137be7"
      ]
    ]
  },
  {
    "id": "fb170cb858137be7",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "check measurement",
    "property": "measurement",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "camera",
        "vt": "str"
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 320,
    "y": 3120,
    "wires": [
      [
        "24f76309a6dfe14a"
      ]
    ]
  },
  {
    "id": "b74b0ea99d56eb7e",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "rstp",
    "rules": [
      {
        "t": "set",
        "p": "rstp",
        "pt": "msg",
        "to": "payload",
        "tot": "msg"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 730,
    "y": 3120,
    "wires": [
      []
    ]
  },
  {
    "id": "ea0406109e5de115",
    "type": "ui-control",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "",
    "ui": "2d75e4809d2a6fbf",
    "events": "all",
    "x": 900,
    "y": 2880,
    "wires": [
      []
    ]
  },
  {
    "id": "03b02d165b1d7e28",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "group": "0083c332a401849d",
    "order": 1,
    "width": "6",
    "height": "1",
    "name": "none",
    "label": "",
    "format": "{{msg.payload}}",
    "layout": "row-center",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 1070,
    "y": 2820,
    "wires": []
  },
  {
    "id": "153555b528c18e18",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "payload",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "Aucune caméra",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 900,
    "y": 2820,
    "wires": [
      [
        "03b02d165b1d7e28"
      ]
    ]
  },
  {
    "id": "263b6e6e05263288",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "image to payload",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "'data:image/png;base64,'&msg.payload",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 2110,
    "y": 3060,
    "wires": [
      [
        "b60115a1fd023b76"
      ]
    ]
  },
  {
    "id": "b60115a1fd023b76",
    "type": "ui-template",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "group": "0083c332a401849d",
    "page": "",
    "ui": "",
    "name": "image",
    "order": 2,
    "width": "6",
    "height": "7",
    "head": "",
    "format": "<template>\n    <img ref=\"iotnode-camera\" class=\"\" alt=\"Aucune camera\" width=\"100%\" src=\"\" />\n</template>\n\n<script>\nexport default {\n  name: 'MyCamera',\n  mounted () {\n    this.$socket.on('msg-input:' + this.id, (msg) => {\n        // get the Video's DOM element\n        const iotnodecamera = this.$refs['iotnode-camera']\n\n        if (msg.class==='remove') {\n          iotnodecamera.class = 'remove'\n        } else {\n          iotnodecamera.class = ''\n          iotnodecamera.src = msg.payload\n        }\n    })\n  },\n  unmounted () {\n    this.$socket.off(`msg-input:${this.id}`)\n  }\n}\n</script>",
    "storeOutMessages": true,
    "passthru": true,
    "resendOnRefresh": true,
    "templateScope": "local",
    "className": "",
    "x": 2310,
    "y": 2940,
    "wires": [
      []
    ]
  },
  {
    "id": "c2aa1840a5deddbf",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "to empty",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "",
        "tot": "str"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "remove",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 900,
    "y": 2940,
    "wires": [
      [
        "b60115a1fd023b76",
        "62c1bb0cb832960f"
      ]
    ]
  },
  {
    "id": "62c1bb0cb832960f",
    "type": "trigger",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "repeat once",
    "op1": "",
    "op2": "",
    "op1type": "pay",
    "op2type": "pay",
    "duration": "250",
    "extend": false,
    "overrideDelay": false,
    "units": "ms",
    "reset": "",
    "bytopic": "all",
    "topic": "topic",
    "outputs": 1,
    "x": 1090,
    "y": 3000,
    "wires": [
      [
        "4adc84859872765c"
      ]
    ]
  },
  {
    "id": "8aa78c963092f63a",
    "type": "trigger",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "repeat once",
    "op1": "",
    "op2": "",
    "op1type": "pay",
    "op2type": "pay",
    "duration": "1",
    "extend": false,
    "overrideDelay": false,
    "units": "s",
    "reset": "",
    "bytopic": "all",
    "topic": "topic",
    "outputs": 1,
    "x": 1090,
    "y": 3060,
    "wires": [
      [
        "4adc84859872765c"
      ]
    ]
  },
  {
    "id": "16094297767ce839",
    "type": "base64",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "",
    "action": "str",
    "property": "payload",
    "x": 1900,
    "y": 3060,
    "wires": [
      [
        "263b6e6e05263288"
      ]
    ]
  },
  {
    "id": "a2a26d3c15589044",
    "type": "catch",
    "z": "aab0c030de7df5cc",
    "g": "f68e8c6415aca870",
    "name": "catch error",
    "scope": null,
    "uncaught": false,
    "x": 620,
    "y": 60,
    "wires": [
      [
        "fcaaaca3a27426b7"
      ]
    ]
  },
  {
    "id": "fcaaaca3a27426b7",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "f68e8c6415aca870",
    "name": "topic",
    "rules": [
      {
        "t": "set",
        "p": "topic",
        "pt": "msg",
        "to": "room",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 790,
    "y": 60,
    "wires": [
      [
        "69fc7c7c14fa81f3"
      ]
    ]
  },
  {
    "id": "69fc7c7c14fa81f3",
    "type": "link out",
    "z": "aab0c030de7df5cc",
    "g": "f68e8c6415aca870",
    "name": "catch error",
    "mode": "link",
    "links": [
      "a52f0e788cd4dca3"
    ],
    "x": 915,
    "y": 60,
    "wires": []
  },
  {
    "id": "ec99f621f7253cd7",
    "type": "ui-chart",
    "z": "aab0c030de7df5cc",
    "g": "a3df49e3ec177d8d",
    "group": "1a2635629b812ca3",
    "name": "chart temperature",
    "label": "",
    "order": 9007199254740991,
    "chartType": "line",
    "category": "_field",
    "categoryType": "property",
    "xAxisProperty": "_time",
    "xAxisPropertyType": "msg",
    "xAxisType": "time",
    "yAxisProperty": "_value",
    "ymin": "",
    "ymax": "",
    "action": "replace",
    "pointShape": "false",
    "pointRadius": "2",
    "showLegend": false,
    "removeOlder": 1,
    "removeOlderUnit": "86400",
    "removeOlderPoints": "100",
    "colors": [
      "#008080",
      "#aec7e8",
      "#ff7f0e",
      "#2ca02c",
      "#98df8a",
      "#d62728",
      "#ff9896",
      "#9467bd",
      "#c5b0d5"
    ],
    "width": 6,
    "height": "6",
    "className": "",
    "x": 1170,
    "y": 1140,
    "wires": [
      []
    ]
  },
  {
    "id": "023b97f731941ec8",
    "type": "influxdb in",
    "z": "aab0c030de7df5cc",
    "g": "a3df49e3ec177d8d",
    "influxdb": "e408b55d1dc6870d",
    "name": "",
    "query": "",
    "rawOutput": false,
    "precision": "",
    "retentionPolicy": "",
    "org": "iotredloop",
    "x": 780,
    "y": 1140,
    "wires": [
      [
        "20c48f73de388537",
        "c1d200de7bed7d83"
      ]
    ]
  },
  {
    "id": "d83b592e2491dcb6",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "a3df49e3ec177d8d",
    "name": "query",
    "rules": [
      {
        "t": "set",
        "p": "query",
        "pt": "msg",
        "to": "'from(bucket: \"'&msg.bucket&'\")\t  |> range(start: -1d, stop:now())\t  |> aggregateWindow(every: 60s, fn: last, createEmpty: false)\t  |> filter(fn: (r) =>\t    r._measurement == \"temperature\"\t  )'",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 590,
    "y": 1140,
    "wires": [
      [
        "023b97f731941ec8"
      ]
    ]
  },
  {
    "id": "e44987d599f2b366",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "a3df49e3ec177d8d",
    "name": "room - ui - chart temperature - metric",
    "links": [
      "b6323e1460f6f50c"
    ],
    "x": 135,
    "y": 1140,
    "wires": [
      [
        "b6d352f0739c9c5d"
      ]
    ]
  },
  {
    "id": "b6d352f0739c9c5d",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "a3df49e3ec177d8d",
    "name": "check if measurement exists",
    "property": "measurement",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "temperature",
        "vt": "str"
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 360,
    "y": 1140,
    "wires": [
      [
        "d83b592e2491dcb6"
      ]
    ]
  },
  {
    "id": "e01a8d98754f1f85",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "a3df49e3ec177d8d",
    "name": "room - ui - chart temperature - load",
    "links": [
      "9e4bfee0db3051d4"
    ],
    "x": 135,
    "y": 1020,
    "wires": [
      [
        "fc6afa9a094180d3"
      ]
    ]
  },
  {
    "id": "3918bb15caaf1ec5",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "g": "a3df49e3ec177d8d",
    "group": "1a2635629b812ca3",
    "order": 1,
    "width": "6",
    "height": "1",
    "name": "none",
    "label": "",
    "format": "{{msg.payload}}",
    "layout": "row-center",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 1310,
    "y": 1020,
    "wires": []
  },
  {
    "id": "4a56f9148bd23d8e",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "a3df49e3ec177d8d",
    "name": "payload",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "Aucun relevé de température",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1140,
    "y": 1020,
    "wires": [
      [
        "3918bb15caaf1ec5"
      ]
    ]
  },
  {
    "id": "fc6afa9a094180d3",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "a3df49e3ec177d8d",
    "name": "reset",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "{\t   \"groups\":{\t       \"hide\":[\"Pièces:Température\"]\t   }\t}",
        "tot": "jsonata"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 970,
    "y": 1020,
    "wires": [
      [
        "44d4e7ddd6c2f416",
        "4a56f9148bd23d8e"
      ]
    ]
  },
  {
    "id": "c1d200de7bed7d83",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "a3df49e3ec177d8d",
    "name": "set",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "{\t   \"groups\":{\t       \"show\":[\"Pièces:Température\"]\t   }\t}",
        "tot": "jsonata"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "remove",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 970,
    "y": 1080,
    "wires": [
      [
        "44d4e7ddd6c2f416",
        "4a56f9148bd23d8e"
      ]
    ]
  },
  {
    "id": "44d4e7ddd6c2f416",
    "type": "ui-control",
    "z": "aab0c030de7df5cc",
    "g": "a3df49e3ec177d8d",
    "name": "",
    "ui": "2d75e4809d2a6fbf",
    "events": "all",
    "x": 1140,
    "y": 1080,
    "wires": [
      []
    ]
  },
  {
    "id": "20c48f73de388537",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "a3df49e3ec177d8d",
    "name": "class",
    "rules": [
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 970,
    "y": 1140,
    "wires": [
      [
        "ec99f621f7253cd7"
      ]
    ]
  },
  {
    "id": "1f143110084f2d12",
    "type": "ui-chart",
    "z": "aab0c030de7df5cc",
    "g": "80f986da1d02c67c",
    "group": "e41130e3f4e3f1fe",
    "name": "chart humidity",
    "label": "",
    "order": 9007199254740991,
    "chartType": "line",
    "category": "_field",
    "categoryType": "property",
    "xAxisProperty": "_time",
    "xAxisPropertyType": "msg",
    "xAxisType": "time",
    "yAxisProperty": "_value",
    "ymin": "",
    "ymax": "",
    "action": "replace",
    "pointShape": "false",
    "pointRadius": "2",
    "showLegend": false,
    "removeOlder": 1,
    "removeOlderUnit": "86400",
    "removeOlderPoints": "100",
    "colors": [
      "#008080",
      "#aec7e8",
      "#ff7f0e",
      "#2ca02c",
      "#98df8a",
      "#d62728",
      "#ff9896",
      "#9467bd",
      "#c5b0d5"
    ],
    "width": 6,
    "height": "6",
    "className": "",
    "x": 1160,
    "y": 1380,
    "wires": [
      []
    ]
  },
  {
    "id": "c95545cb575e900a",
    "type": "influxdb in",
    "z": "aab0c030de7df5cc",
    "g": "80f986da1d02c67c",
    "influxdb": "e408b55d1dc6870d",
    "name": "",
    "query": "",
    "rawOutput": false,
    "precision": "",
    "retentionPolicy": "",
    "org": "iotredloop",
    "x": 780,
    "y": 1380,
    "wires": [
      [
        "238894bac5405d86",
        "40fb52f0b9b6d6f8"
      ]
    ]
  },
  {
    "id": "a521b0c77c8e1b96",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "80f986da1d02c67c",
    "name": "query",
    "rules": [
      {
        "t": "set",
        "p": "query",
        "pt": "msg",
        "to": "'from(bucket: \"'&msg.bucket&'\")\t  |> range(start: -1d, stop:now())\t  |> aggregateWindow(every: 60s, fn: last, createEmpty: false)\t  |> filter(fn: (r) =>\t    r._measurement == \"humidity\"\t  )'",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 590,
    "y": 1380,
    "wires": [
      [
        "c95545cb575e900a"
      ]
    ]
  },
  {
    "id": "057bd2913e07a3dc",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "80f986da1d02c67c",
    "name": "room - ui - chart humidity - metric",
    "links": [
      "b6323e1460f6f50c"
    ],
    "x": 135,
    "y": 1380,
    "wires": [
      [
        "588f7e8cf7861975"
      ]
    ]
  },
  {
    "id": "588f7e8cf7861975",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "80f986da1d02c67c",
    "name": "check if measurement exists",
    "property": "measurement",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "humidity",
        "vt": "str"
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 360,
    "y": 1380,
    "wires": [
      [
        "a521b0c77c8e1b96"
      ]
    ]
  },
  {
    "id": "feae7dc17ccbe84b",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "80f986da1d02c67c",
    "name": "room - ui - chart humidity - load",
    "links": [
      "9e4bfee0db3051d4"
    ],
    "x": 135,
    "y": 1260,
    "wires": [
      [
        "13bb4993d29c190f"
      ]
    ]
  },
  {
    "id": "40fb52f0b9b6d6f8",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "80f986da1d02c67c",
    "name": "set",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "{\t   \"groups\":{\t       \"show\":[\"Pièces:Humidité\"]\t   }\t}",
        "tot": "jsonata"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "remove",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 970,
    "y": 1320,
    "wires": [
      [
        "4fac1159c7fb1196",
        "280a3b24aff09fd6"
      ]
    ]
  },
  {
    "id": "5943f812794763bb",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "g": "80f986da1d02c67c",
    "group": "e41130e3f4e3f1fe",
    "order": 1,
    "width": "6",
    "height": "1",
    "name": "none",
    "label": "",
    "format": "{{msg.payload}}",
    "layout": "row-center",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 1310,
    "y": 1260,
    "wires": []
  },
  {
    "id": "280a3b24aff09fd6",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "80f986da1d02c67c",
    "name": "payload",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "Aucun relevé d'humidité",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1140,
    "y": 1260,
    "wires": [
      [
        "5943f812794763bb"
      ]
    ]
  },
  {
    "id": "13bb4993d29c190f",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "80f986da1d02c67c",
    "name": "reset",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "{\t   \"groups\":{\t       \"hide\":[\"Pièces:Humidité\"]\t   }\t}",
        "tot": "jsonata"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 970,
    "y": 1260,
    "wires": [
      [
        "4fac1159c7fb1196",
        "280a3b24aff09fd6"
      ]
    ]
  },
  {
    "id": "4fac1159c7fb1196",
    "type": "ui-control",
    "z": "aab0c030de7df5cc",
    "g": "80f986da1d02c67c",
    "name": "",
    "ui": "2d75e4809d2a6fbf",
    "events": "all",
    "x": 1140,
    "y": 1320,
    "wires": [
      []
    ]
  },
  {
    "id": "238894bac5405d86",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "80f986da1d02c67c",
    "name": "class",
    "rules": [
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 970,
    "y": 1380,
    "wires": [
      [
        "1f143110084f2d12"
      ]
    ]
  },
  {
    "id": "ff3ea6db082a3ede",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "group": "",
    "order": 2,
    "width": "1",
    "height": "1",
    "name": "current",
    "label": "",
    "format": "{{msg.payload}}",
    "layout": "row-spread",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 1460,
    "y": 3660,
    "wires": []
  },
  {
    "id": "7a8446bfe5858de9",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "group": "",
    "order": 1,
    "width": "5",
    "height": "1",
    "name": "power",
    "label": "Puissance",
    "format": "{{msg.payload}}",
    "layout": "row-spread",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 1450,
    "y": 3600,
    "wires": []
  },
  {
    "id": "7ca84197b56de1f6",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "group": "",
    "order": 4,
    "width": "6",
    "height": "1",
    "name": "tariff",
    "label": "Tarif",
    "format": "{{msg.payload}}",
    "layout": "row-spread",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 1450,
    "y": 3720,
    "wires": []
  },
  {
    "id": "5f8cd6bd9f561403",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "group": "",
    "order": 5,
    "width": "6",
    "height": "1",
    "name": "conso_total_today",
    "label": "Consommation ajourdh'ui",
    "format": "{{msg.payload}}",
    "layout": "row-spread",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 1490,
    "y": 3780,
    "wires": []
  },
  {
    "id": "3c5b954c4db04bdb",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "group": "",
    "order": 6,
    "width": "6",
    "height": "1",
    "name": "conso_total_yesturday",
    "label": "Consommation hier",
    "format": "{{msg.payload}}",
    "layout": "row-spread",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 1500,
    "y": 3840,
    "wires": []
  },
  {
    "id": "3a816c9d45c03626",
    "type": "influxdb in",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "influxdb": "e408b55d1dc6870d",
    "name": "",
    "query": "",
    "rawOutput": false,
    "precision": "",
    "retentionPolicy": "",
    "org": "iotredloop",
    "x": 900,
    "y": 3780,
    "wires": [
      [
        "6ef64156f6aee952"
      ]
    ]
  },
  {
    "id": "d387848d485bbad4",
    "type": "influxdb in",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "influxdb": "e408b55d1dc6870d",
    "name": "",
    "query": "import \"date\"\nfrom(bucket: \"linky\")\n  |> range(start: date.truncate(t:-1d,unit:1d), stop: date.truncate(t:0d,unit:1d))\n  |> filter(fn: (r) =>\n    r._field == \"conso_total_day\"\n  )\n  |> aggregateWindow(every: 24h, fn: max)",
    "rawOutput": false,
    "precision": "",
    "retentionPolicy": "",
    "org": "iotredloop",
    "x": 900,
    "y": 3840,
    "wires": [
      [
        "ab09e46f4313cec3"
      ]
    ]
  },
  {
    "id": "88b4fa01095bf6be",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "format",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "payload.0['_value']",
        "tot": "msg"
      },
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "$round($number(msg.payload)/1000, 1)&'kWh'",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1290,
    "y": 3780,
    "wires": [
      [
        "5f8cd6bd9f561403"
      ]
    ]
  },
  {
    "id": "9afdec924f923d90",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "format",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "payload.0['_value']",
        "tot": "msg"
      },
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "$round(msg.payload/1000, 1)&'kWh'",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1290,
    "y": 3840,
    "wires": [
      [
        "3c5b954c4db04bdb"
      ]
    ]
  },
  {
    "id": "6ef64156f6aee952",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "has values",
    "property": "payload",
    "propertyType": "msg",
    "rules": [
      {
        "t": "nempty"
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 1110,
    "y": 3780,
    "wires": [
      [
        "88b4fa01095bf6be"
      ]
    ]
  },
  {
    "id": "ab09e46f4313cec3",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "has values",
    "property": "payload",
    "propertyType": "msg",
    "rules": [
      {
        "t": "nempty"
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 1110,
    "y": 3840,
    "wires": [
      [
        "9afdec924f923d90"
      ]
    ]
  },
  {
    "id": "88a3ebf72baa83c9",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "room - ui - chart temperature - load",
    "links": [
      "9e4bfee0db3051d4"
    ],
    "x": 135,
    "y": 3420,
    "wires": [
      [
        "76f6a0873cbd318f",
        "ce16a38c205cea88"
      ]
    ]
  },
  {
    "id": "7bde9e5371850ec6",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "group": "",
    "order": 1,
    "width": "6",
    "height": "1",
    "name": "none",
    "label": "",
    "format": "{{msg.payload}}",
    "layout": "row-center",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 1630,
    "y": 3420,
    "wires": []
  },
  {
    "id": "94a9afc0489abcb3",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "payload",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "Aucun compteur d'énergie",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1460,
    "y": 3420,
    "wires": [
      [
        "7bde9e5371850ec6"
      ]
    ]
  },
  {
    "id": "76f6a0873cbd318f",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "reset",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "{\t   \"groups\":{\t       \"hide\":[\"Pièces:Electricité\"]\t   }\t}",
        "tot": "jsonata"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1290,
    "y": 3420,
    "wires": [
      [
        "2c63dd2b7c70df86",
        "94a9afc0489abcb3"
      ]
    ]
  },
  {
    "id": "a86d64f42452a3b7",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "set",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "{\t   \"groups\":{\t       \"show\":[\"Pièces:Electricité\"]\t   }\t}",
        "tot": "jsonata"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "remove",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1290,
    "y": 3480,
    "wires": [
      [
        "2c63dd2b7c70df86",
        "94a9afc0489abcb3"
      ]
    ]
  },
  {
    "id": "2c63dd2b7c70df86",
    "type": "ui-control",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "",
    "ui": "2d75e4809d2a6fbf",
    "events": "all",
    "x": 1460,
    "y": 3480,
    "wires": [
      []
    ]
  },
  {
    "id": "ce16a38c205cea88",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "reset",
    "rules": [],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1290,
    "y": 3540,
    "wires": [
      [
        "7a8446bfe5858de9",
        "ff3ea6db082a3ede",
        "7ca84197b56de1f6",
        "5f8cd6bd9f561403",
        "3c5b954c4db04bdb"
      ]
    ]
  },
  {
    "id": "223c9437360c96cb",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "room - ui - seen - metric",
    "links": [
      "b6323e1460f6f50c"
    ],
    "x": 135,
    "y": 3480,
    "wires": [
      [
        "8a1c1129f96fc4f7"
      ]
    ]
  },
  {
    "id": "8a1c1129f96fc4f7",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "measurement",
    "property": "measurement",
    "propertyType": "msg",
    "rules": [
      {
        "t": "eq",
        "v": "power",
        "vt": "str"
      },
      {
        "t": "eq",
        "v": "current",
        "vt": "str"
      },
      {
        "t": "eq",
        "v": "tariff",
        "vt": "str"
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 3,
    "x": 300,
    "y": 3480,
    "wires": [
      [
        "a86d64f42452a3b7",
        "674e46c767bb1ff9",
        "636a8238144e0df5"
      ],
      [
        "a86d64f42452a3b7",
        "53c25ef43112837d"
      ],
      [
        "a86d64f42452a3b7",
        "da46e6b6c18a5350"
      ]
    ]
  },
  {
    "id": "2da12c408933c87b",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "payload",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "msg.payload&'W'",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1280,
    "y": 3600,
    "wires": [
      [
        "7a8446bfe5858de9"
      ]
    ]
  },
  {
    "id": "9725fd4ac3730948",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "payload",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "'('&msg.payload&'A)'",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1280,
    "y": 3660,
    "wires": [
      [
        "ff3ea6db082a3ede"
      ]
    ]
  },
  {
    "id": "bb91528b79a7fef4",
    "type": "function",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "HP/HC",
    "func": "if (msg.payload=='HP'){\n    msg.payload='Heures pleines';\n} else {\n    msg.payload='Heures creuses';\n}\nreturn msg;",
    "outputs": 1,
    "timeout": "",
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": [],
    "x": 1280,
    "y": 3720,
    "wires": [
      [
        "7ca84197b56de1f6"
      ]
    ]
  },
  {
    "id": "5ee9de3d5907e482",
    "type": "delay",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "",
    "pauseType": "rate",
    "timeout": "5",
    "timeoutUnits": "seconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "minute",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": true,
    "allowrate": false,
    "outputs": 1,
    "x": 680,
    "y": 3780,
    "wires": [
      [
        "3a816c9d45c03626",
        "d387848d485bbad4"
      ]
    ]
  },
  {
    "id": "f8bf0c474caebb26",
    "type": "comment",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "from db bucket linky",
    "info": "",
    "x": 690,
    "y": 3840,
    "wires": []
  },
  {
    "id": "da46e6b6c18a5350",
    "type": "delay",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "40 ms",
    "pauseType": "delay",
    "timeout": "40",
    "timeoutUnits": "milliseconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "second",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": false,
    "allowrate": false,
    "outputs": 1,
    "x": 490,
    "y": 3720,
    "wires": [
      [
        "bb91528b79a7fef4"
      ]
    ]
  },
  {
    "id": "53c25ef43112837d",
    "type": "delay",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "40 ms",
    "pauseType": "delay",
    "timeout": "40",
    "timeoutUnits": "milliseconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "second",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": false,
    "allowrate": false,
    "outputs": 1,
    "x": 490,
    "y": 3660,
    "wires": [
      [
        "9725fd4ac3730948"
      ]
    ]
  },
  {
    "id": "674e46c767bb1ff9",
    "type": "delay",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "40 ms",
    "pauseType": "delay",
    "timeout": "40",
    "timeoutUnits": "milliseconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "second",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": false,
    "allowrate": false,
    "outputs": 1,
    "x": 490,
    "y": 3600,
    "wires": [
      [
        "2da12c408933c87b"
      ]
    ]
  },
  {
    "id": "636a8238144e0df5",
    "type": "delay",
    "z": "aab0c030de7df5cc",
    "d": true,
    "g": "37f02e75f6e70daa",
    "name": "20 ms",
    "pauseType": "delay",
    "timeout": "20",
    "timeoutUnits": "milliseconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "second",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": false,
    "allowrate": false,
    "outputs": 1,
    "x": 490,
    "y": 3780,
    "wires": [
      [
        "5ee9de3d5907e482"
      ]
    ]
  },
  {
    "id": "44795f19725dfb16",
    "type": "ui-chart",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "group": "c19749d8e5cc1e1f",
    "name": "chart power",
    "label": "",
    "order": 4,
    "chartType": "line",
    "category": "_field",
    "categoryType": "property",
    "xAxisProperty": "_time",
    "xAxisPropertyType": "msg",
    "xAxisType": "time",
    "yAxisProperty": "_value",
    "ymin": "",
    "ymax": "",
    "action": "replace",
    "pointShape": "false",
    "pointRadius": "2",
    "showLegend": false,
    "removeOlder": 1,
    "removeOlderUnit": "86400",
    "removeOlderPoints": "150",
    "colors": [
      "#008080",
      "#aec7e8",
      "#ff7f0e",
      "#2ca02c",
      "#98df8a",
      "#d62728",
      "#ff9896",
      "#9467bd",
      "#c5b0d5"
    ],
    "width": 6,
    "height": "6",
    "className": "",
    "x": 2290,
    "y": 1800,
    "wires": [
      []
    ]
  },
  {
    "id": "2b909499790cab01",
    "type": "influxdb in",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "influxdb": "e408b55d1dc6870d",
    "name": "",
    "query": "",
    "rawOutput": false,
    "precision": "",
    "retentionPolicy": "",
    "org": "iotredloop",
    "x": 1920,
    "y": 1800,
    "wires": [
      [
        "5cc27b9e016bbe1b"
      ]
    ]
  },
  {
    "id": "73cb2cee63b22726",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "query",
    "rules": [
      {
        "t": "set",
        "p": "query",
        "pt": "msg",
        "to": "'from(bucket: \"'&msg.bucket&'\")\t  |> range(start: -1d, stop:now())\t  |> aggregateWindow(every: 10m, fn: last, createEmpty: false)\t  |> filter(fn: (r) =>\t    r._measurement == \"'&msg.measurement&'\" and r._field == \"'&msg.field&'\"\t  )'",
        "tot": "jsonata"
      },
      {
        "t": "set",
        "p": "topic",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1730,
    "y": 1800,
    "wires": [
      [
        "2b909499790cab01"
      ]
    ]
  },
  {
    "id": "eeab0942d3417e79",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "room - ui - chart power - metric",
    "links": [
      "b6323e1460f6f50c"
    ],
    "x": 135,
    "y": 1560,
    "wires": [
      [
        "fea7dd1138155750"
      ]
    ]
  },
  {
    "id": "23dabc507247dfc0",
    "type": "link in",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "room - ui - chart power - load",
    "links": [
      "9e4bfee0db3051d4"
    ],
    "x": 135,
    "y": 1500,
    "wires": [
      [
        "ecd8bf936f027cdc",
        "ea377511bda2edc5"
      ]
    ]
  },
  {
    "id": "992ae204a4e2dac4",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "set",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "{\t   \"groups\":{\t       \"show\":[\"Pièces:Puissance électrique\"]\t   }\t}",
        "tot": "jsonata"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "remove",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1190,
    "y": 1560,
    "wires": [
      [
        "c60c3603ff04bca1",
        "b9f8b477c288e0f0",
        "4ca2710a68ee8cf7",
        "a8c19f86a71e21fe"
      ]
    ]
  },
  {
    "id": "32acac8443b52345",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "group": "c19749d8e5cc1e1f",
    "order": 1,
    "width": "6",
    "height": "1",
    "name": "none",
    "label": "",
    "format": "{{msg.payload}}",
    "layout": "row-center",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 2450,
    "y": 1500,
    "wires": []
  },
  {
    "id": "b9f8b477c288e0f0",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "payload",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "Aucun relevé de puissance",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 2280,
    "y": 1500,
    "wires": [
      [
        "32acac8443b52345"
      ]
    ]
  },
  {
    "id": "ecd8bf936f027cdc",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "reset",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "{\t   \"groups\":{\t       \"hide\":[\"Pièces:Puissance électrique\"]\t   }\t}",
        "tot": "jsonata"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1190,
    "y": 1500,
    "wires": [
      [
        "c60c3603ff04bca1",
        "b9f8b477c288e0f0"
      ]
    ]
  },
  {
    "id": "c60c3603ff04bca1",
    "type": "ui-control",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "",
    "ui": "2d75e4809d2a6fbf",
    "events": "all",
    "x": 2280,
    "y": 1560,
    "wires": [
      []
    ]
  },
  {
    "id": "5cc27b9e016bbe1b",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "class",
    "rules": [
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 2110,
    "y": 1800,
    "wires": [
      [
        "44795f19725dfb16"
      ]
    ]
  },
  {
    "id": "fea7dd1138155750",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "check if measurement exists",
    "property": "measurement",
    "propertyType": "msg",
    "rules": [
      {
        "t": "regex",
        "v": "(power|tariff)",
        "vt": "str",
        "case": false
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 340,
    "y": 1560,
    "wires": [
      [
        "2b7c57be9b721cd6"
      ]
    ]
  },
  {
    "id": "ce300a4fa3da028b",
    "type": "link call",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "",
    "links": [
      "df0e4ab2e1efc286"
    ],
    "linkType": "static",
    "timeout": "30",
    "x": 1920,
    "y": 1680,
    "wires": [
      [
        "5c3172390ae5eefb"
      ]
    ]
  },
  {
    "id": "5c3172390ae5eefb",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "format",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "msg.trans&' à '&msg.payload&'W'",
        "tot": "jsonata"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 2110,
    "y": 1680,
    "wires": [
      [
        "898d54359ae10f09"
      ]
    ]
  },
  {
    "id": "898d54359ae10f09",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "group": "c19749d8e5cc1e1f",
    "order": 2,
    "width": "6",
    "height": "1",
    "name": "power",
    "label": "",
    "format": "{{msg.payload}}",
    "layout": "row-right",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 2270,
    "y": 1680,
    "wires": []
  },
  {
    "id": "4ca2710a68ee8cf7",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "reset",
    "rules": [],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 2110,
    "y": 1620,
    "wires": [
      [
        "44795f19725dfb16",
        "898d54359ae10f09",
        "8bc96e353c45fe20"
      ]
    ]
  },
  {
    "id": "9775046f290c1bf5",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "reset",
    "rules": [],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 730,
    "y": 3000,
    "wires": [
      [
        "b7732e5da33d4247",
        "0ff03eeb1954d8f2"
      ]
    ]
  },
  {
    "id": "c32cc33c321acd07",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "set metric",
    "rules": [
      {
        "t": "set",
        "p": "measurement",
        "pt": "msg",
        "to": "camera",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1080,
    "y": 3180,
    "wires": [
      [
        "8c7c93ce9d3d346c"
      ]
    ]
  },
  {
    "id": "8c7c93ce9d3d346c",
    "type": "link out",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "room - ui - camera - metric",
    "mode": "link",
    "links": [
      "2690f4e06626ebda"
    ],
    "x": 1215,
    "y": 3180,
    "wires": []
  },
  {
    "id": "b7732e5da33d4247",
    "type": "ui-switch",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "snapshot",
    "label": "",
    "group": "0083c332a401849d",
    "order": 4,
    "width": "1",
    "height": "1",
    "passthru": false,
    "topic": "snapshot",
    "topicType": "str",
    "style": "",
    "className": "",
    "onvalue": "true",
    "onvalueType": "bool",
    "onicon": "camera-wireless",
    "oncolor": "teal",
    "offvalue": "false",
    "offvalueType": "bool",
    "officon": "camera-off-outline",
    "offcolor": "grey",
    "x": 900,
    "y": 3180,
    "wires": [
      [
        "c32cc33c321acd07"
      ]
    ]
  },
  {
    "id": "ae7ba0058dad62d1",
    "type": "delay",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "20 ms",
    "pauseType": "delay",
    "timeout": "20",
    "timeoutUnits": "milliseconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "second",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": false,
    "allowrate": false,
    "outputs": 1,
    "x": 730,
    "y": 3180,
    "wires": [
      [
        "b7732e5da33d4247",
        "8dfe90979253107e"
      ]
    ]
  },
  {
    "id": "0ff03eeb1954d8f2",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "group": "0083c332a401849d",
    "order": 3,
    "width": "5",
    "height": "1",
    "name": "snapshot (txt)",
    "label": "",
    "format": "{{msg.payload}}",
    "layout": "row-right",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 1100,
    "y": 3120,
    "wires": []
  },
  {
    "id": "8dfe90979253107e",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "42c0f1473438a281",
    "name": "format",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "msg.payload?'Capture de mouvement active':'Capture de mouvement inactive'",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 890,
    "y": 3120,
    "wires": [
      [
        "0ff03eeb1954d8f2"
      ]
    ]
  },
  {
    "id": "b0e2b38384530493",
    "type": "ui-switch",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "motion",
    "label": "",
    "group": "82b3ef69e7817bbb",
    "order": 3,
    "width": "1",
    "height": "1",
    "passthru": false,
    "topic": "topic",
    "topicType": "msg",
    "style": "",
    "className": "",
    "onvalue": "true",
    "onvalueType": "bool",
    "onicon": "motion-sensor",
    "oncolor": "teal",
    "offvalue": "false",
    "offvalueType": "bool",
    "officon": "motion-sensor-off",
    "offcolor": "grey",
    "x": 2150,
    "y": 2580,
    "wires": [
      []
    ]
  },
  {
    "id": "adf79dcb4ba8b960",
    "type": "ui-switch",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "luminosity",
    "label": "",
    "group": "82b3ef69e7817bbb",
    "order": 9,
    "width": "1",
    "height": "1",
    "passthru": false,
    "topic": "topic",
    "topicType": "msg",
    "style": "",
    "className": "",
    "onvalue": "true",
    "onvalueType": "bool",
    "onicon": "sun-angle",
    "oncolor": "teal",
    "offvalue": "false",
    "offvalueType": "bool",
    "officon": "sun-angle-outline",
    "offcolor": "grey",
    "x": 2160,
    "y": 2460,
    "wires": [
      []
    ]
  },
  {
    "id": "25fcf6d56ac6dc3a",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "format",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "msg.payload>50",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1970,
    "y": 2460,
    "wires": [
      [
        "adf79dcb4ba8b960"
      ]
    ]
  },
  {
    "id": "308199e1755f6e79",
    "type": "ui-switch",
    "z": "aab0c030de7df5cc",
    "name": "humidity",
    "label": "",
    "group": "82b3ef69e7817bbb",
    "order": 7,
    "width": "1",
    "height": "1",
    "passthru": false,
    "topic": "topic",
    "topicType": "msg",
    "style": "",
    "className": "",
    "onvalue": "true",
    "onvalueType": "bool",
    "onicon": "water",
    "oncolor": "teal",
    "offvalue": "false",
    "offvalueType": "bool",
    "officon": "water-outline",
    "offcolor": "grey",
    "x": 2160,
    "y": 2400,
    "wires": [
      []
    ]
  },
  {
    "id": "18e8c1312e9832c1",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "format",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "msg.payload>50",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1970,
    "y": 2340,
    "wires": [
      [
        "308199e1755f6e79"
      ]
    ]
  },
  {
    "id": "2109f9c2efef71b7",
    "type": "ui-switch",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "temperature",
    "label": "",
    "group": "82b3ef69e7817bbb",
    "order": 5,
    "width": "1",
    "height": "1",
    "passthru": false,
    "topic": "topic",
    "topicType": "msg",
    "style": "",
    "className": "",
    "onvalue": "true",
    "onvalueType": "bool",
    "onicon": "thermometer",
    "oncolor": "teal",
    "offvalue": "false",
    "offvalueType": "bool",
    "officon": "thermometer-low",
    "offcolor": "grey",
    "x": 2170,
    "y": 2220,
    "wires": [
      []
    ]
  },
  {
    "id": "d37f5597502da265",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "format",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "msg.payload>22",
        "tot": "jsonata"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1970,
    "y": 2220,
    "wires": [
      [
        "2109f9c2efef71b7"
      ]
    ]
  },
  {
    "id": "cecdc0524ebf11ca",
    "type": "ui-switch",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "fire",
    "label": "",
    "group": "82b3ef69e7817bbb",
    "order": 11,
    "width": "1",
    "height": "1",
    "passthru": false,
    "topic": "topic",
    "topicType": "msg",
    "style": "",
    "className": "",
    "onvalue": "true",
    "onvalueType": "bool",
    "onicon": "fire-alert",
    "oncolor": "teal",
    "offvalue": "false",
    "offvalueType": "bool",
    "officon": "fire-off",
    "offcolor": "grey",
    "x": 2150,
    "y": 2700,
    "wires": [
      []
    ]
  },
  {
    "id": "c22c3490c00ce12b",
    "type": "delay",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "100 ms",
    "pauseType": "delay",
    "timeout": "100",
    "timeoutUnits": "milliseconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "second",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": false,
    "allowrate": false,
    "outputs": 1,
    "x": 780,
    "y": 2160,
    "wires": [
      [
        "4f1473471bbae45e"
      ]
    ]
  },
  {
    "id": "3cb202072fae30ca",
    "type": "delay",
    "z": "aab0c030de7df5cc",
    "g": "4e8f7076589ea977",
    "name": "50 ms",
    "pauseType": "delay",
    "timeout": "50",
    "timeoutUnits": "milliseconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "second",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": false,
    "allowrate": false,
    "outputs": 1,
    "x": 770,
    "y": 2100,
    "wires": [
      [
        "68ac80a46640bc8a"
      ]
    ]
  },
  {
    "id": "ea377511bda2edc5",
    "type": "delay",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "50 ms",
    "pauseType": "delay",
    "timeout": "50",
    "timeoutUnits": "milliseconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "second",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": false,
    "allowrate": false,
    "outputs": 1,
    "x": 270,
    "y": 1620,
    "wires": [
      [
        "4ca2710a68ee8cf7"
      ]
    ]
  },
  {
    "id": "8bb2921d3035f78f",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "format",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "msg.payload='HP'?'Heures pleines':'Heures creuses'",
        "tot": "jsonata"
      },
      {
        "t": "set",
        "p": "class",
        "pt": "msg",
        "to": "",
        "tot": "str"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 2110,
    "y": 1740,
    "wires": [
      [
        "8bc96e353c45fe20"
      ]
    ]
  },
  {
    "id": "d28afb23b014c0d3",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "from global",
    "rules": [
      {
        "t": "set",
        "p": "power",
        "pt": "msg",
        "to": "metrics[msg.bucket]['power'][msg.field]",
        "tot": "global"
      },
      {
        "t": "set",
        "p": "tariff",
        "pt": "msg",
        "to": "metrics[msg.bucket]['tariff'][msg.field]",
        "tot": "global"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1010,
    "y": 1680,
    "wires": [
      [
        "8baf81aaecbe3ab0",
        "f64316cbc425c3fb"
      ]
    ]
  },
  {
    "id": "2b7c57be9b721cd6",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "check if field exists",
    "property": "field",
    "propertyType": "msg",
    "rules": [
      {
        "t": "regex",
        "v": "(electric meter|solar panels)",
        "vt": "str",
        "case": false
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 610,
    "y": 1560,
    "wires": [
      [
        "154312b0a80ad157",
        "992ae204a4e2dac4"
      ]
    ]
  },
  {
    "id": "8baf81aaecbe3ab0",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "power",
    "property": "power",
    "propertyType": "msg",
    "rules": [
      {
        "t": "nnull"
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 1190,
    "y": 1680,
    "wires": [
      [
        "529b8f85ea492b9a"
      ]
    ]
  },
  {
    "id": "f64316cbc425c3fb",
    "type": "switch",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "tariff",
    "property": "tariff",
    "propertyType": "msg",
    "rules": [
      {
        "t": "nnull"
      }
    ],
    "checkall": "false",
    "repair": false,
    "outputs": 1,
    "x": 1190,
    "y": 1740,
    "wires": [
      [
        "27ccfea85f2033da"
      ]
    ]
  },
  {
    "id": "27ccfea85f2033da",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "move",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "tariff",
        "tot": "msg"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1350,
    "y": 1740,
    "wires": [
      [
        "8bb2921d3035f78f"
      ]
    ]
  },
  {
    "id": "529b8f85ea492b9a",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "move",
    "rules": [
      {
        "t": "set",
        "p": "payload",
        "pt": "msg",
        "to": "power",
        "tot": "msg"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1350,
    "y": 1680,
    "wires": [
      [
        "ce300a4fa3da028b",
        "3e26b34cc3ab9745"
      ]
    ]
  },
  {
    "id": "154312b0a80ad157",
    "type": "delay",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "100 ms",
    "pauseType": "delay",
    "timeout": "100",
    "timeoutUnits": "milliseconds",
    "rate": "1",
    "nbRateUnits": "1",
    "rateUnits": "second",
    "randomFirst": "1",
    "randomLast": "5",
    "randomUnits": "seconds",
    "drop": false,
    "allowrate": false,
    "outputs": 1,
    "x": 820,
    "y": 1680,
    "wires": [
      [
        "d28afb23b014c0d3"
      ]
    ]
  },
  {
    "id": "3e26b34cc3ab9745",
    "type": "trigger",
    "z": "aab0c030de7df5cc",
    "name": "",
    "op1": "",
    "op2": "",
    "op1type": "pay",
    "op2type": "nul",
    "duration": "10",
    "extend": false,
    "overrideDelay": false,
    "units": "s",
    "reset": "",
    "bytopic": "all",
    "topic": "bucket",
    "outputs": 1,
    "x": 1540,
    "y": 1800,
    "wires": [
      [
        "73cb2cee63b22726"
      ]
    ]
  },
  {
    "id": "a8c19f86a71e21fe",
    "type": "change",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "name": "reset",
    "rules": [
      {
        "t": "set",
        "p": "reset",
        "pt": "msg",
        "to": "true",
        "tot": "bool"
      }
    ],
    "action": "",
    "property": "",
    "from": "",
    "to": "",
    "reg": false,
    "x": 1350,
    "y": 1800,
    "wires": [
      [
        "3e26b34cc3ab9745"
      ]
    ]
  },
  {
    "id": "8bc96e353c45fe20",
    "type": "ui-text",
    "z": "aab0c030de7df5cc",
    "g": "0db8801c7e0e4401",
    "group": "c19749d8e5cc1e1f",
    "order": 3,
    "width": "6",
    "height": "1",
    "name": "tariff",
    "label": "",
    "format": "{{msg.payload}}",
    "layout": "row-right",
    "style": false,
    "font": "",
    "fontSize": 16,
    "color": "#717171",
    "className": "",
    "x": 2270,
    "y": 1740,
    "wires": []
  }
]